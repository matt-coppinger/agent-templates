# Final Pipeline Output Spec
# The complete output after revision cycle and human approval

schema:
  brief_id:
    type: string
    required: true

  pipeline_run_id:
    type: string
    required: true
    description: Unique ID for this pipeline execution

  timestamps:
    type: object
    required: true
    fields:
      received: { type: datetime }
      analysed: { type: datetime }
      researched: { type: datetime }
      drafted: { type: datetime }
      reviewed: { type: datetime }
      approved: { type: datetime }
      total_seconds: { type: float, description: "End-to-end pipeline duration" }

  brief_summary:
    type: object
    required: true
    fields:
      content_type: { type: string }
      platform: { type: string }
      target_audience: { type: string }
      tone: { type: string }

  content:
    type: object
    required: true
    fields:
      title: { type: string }
      body: { type: string, description: "Final approved content in markdown" }
      meta_description: { type: string, required: false }
      cta_text: { type: string, required: false }
      hashtags: { type: list, items: { type: string }, required: false }

  quality:
    type: object
    required: true
    fields:
      brand_consistency: { type: float }
      seo_score: { type: float }
      readability: { type: integer }
      factual_accuracy: { type: float }
      overall: { type: float }
      revision_rounds: { type: integer, description: "How many revision cycles were needed" }

  metrics:
    type: object
    required: true
    fields:
      word_count: { type: integer }
      keyword_density_percent: { type: float }
      estimated_reading_time_minutes: { type: float }

  seo_keywords:
    type: object
    required: true
    fields:
      primary: { type: list, items: { type: string } }
      secondary: { type: list, items: { type: string } }

  human_decision:
    type: enum
    required: true
    values: [approved, edited, rejected]

  audit_trail:
    type: list
    required: true
    items:
      type: object
      fields:
        stage: { type: enum, values: [brief-analyser, research-compiler, content-writer, editor, human] }
        output_file: { type: string, description: "Path to full stage output" }
        model_used: { type: string }
        tokens_used: { type: integer }
        cost_estimate: { type: float, description: "Estimated API cost in USD" }
    description: Full traceability for cost tracking
